<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta id="viewport" name="viewport" content="width=device-width,height=device-height,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title>PeerTime</title>
    <link rel="stylesheet" href="style/iconfont.css" />
    <link rel="stylesheet" href="style/whiteboard.css" />
    <script type="text/javascript" src="js/jquery.js"></script>
    <script type="text/javascript" src="js/Common.js"></script>
    <script type="text/javascript" src="js/whiteboard.min.js"></script>
    <!--<script type="text/javascript" src="js/whiteboard.js"></script>-->
    <script type="text/javascript" src="js/jquery.touch.js"></script>
    <script type="text/javascript">
        var whiteboard = new TXTools.default();
        //var whiteboard = new WhiteBoardTool();
        var ISPC = location.href.toLowerCase().indexOf("http") == 0;
        var ISANDROID = location.href.toLowerCase().indexOf("android_asset") > 0;
        var MAINTOUCH = null;
        var ZOOM = 1;
        var PDFCOUNT = 0;
        var PDFURL = "";
        var EVENTSTART = "touchstart", EVENTMOVE = "touchmove", EVENTEND = "touchend", EVENTCLICK = "click";
        //var recorder;
        var PageNumber = 1;
        var ToPageNumber = 1;
        var IsRecord = false;
        var IsPlay = false;
        var RecordTime = null;
        var RecordAction = null;
        var PreZoom = 1;
        var PalyTimer = null;
        var IsShowLog = true;
        var LoadPageTimer = null;
        var PrestrainTimer = null;
        var NewPageList = [];
        var IsToolBarShow = true;
        var ChangePageTimer = null;
        var LastChangeTime = new Date();
        var CurrentAttachmentID = "";
        var MouseTimer = null;
        var LastClickTime = new Date();
        var AfterSelectVideoCall = null;
        var LastVideoTagID = "";
        var IsPPT = false;
        var CurrentScale = 1;
        var CanScroll = true;
        var IsInlineWihteBoardShow = false;
        var PDFMAP = new JsMap();
       

        function BodyOnload()
        {
            InitPage();
            initializeControlWindow();
            window.onresize = function onresize()
            {
                //CheckZoom();
            };
            //$(document.body).pinch(function () { alert("pinch");});
            //$(document.body).pinchIn(function () { alert("pinchIn"); });
            //$(document.body).pinchOut(function () { alert("pinchOut"); });

            //return false;
            //$(document).bind("scroll", function ()
            //{
            //    //alert($(document).scrollTop());
            //    Record_scroll($(document));
            //});
            //$(document.body).find(">div.ui-page").bind("scroll", function ()
            //{
            //    //alert($(this).scrollTop());
            //    Record_scroll($(document.body).find(">div.ui-page"));
            //});
            //ShowPDF('pdf/k6.pdf', 1);
            //ShowPDF('pdf/1.pdf', 1);
            if (ISPC)
            {
                //ShowPDF('1.pdf', 1, "");
                SetSizeMode(1);
                ShowPDF("Test_<10>.jpg", 1);
                //ShowPDF('https://pt.techexcel.com/scripts/texcel/customerwise/TxSwDownload/e2f3020fe2f302dce2f302dce2f308a1/William%27s+demo+ppt.pdf', 1);
                //ShowPPT("https://192.168.22.137:4433/ppt/data/", PageNumber);
                Record();
                //$("#div_btn_toobar").show();
            }
            else
            {

            }
            //ShowMsg(location.href);
            //ShowToolbar(false);
            //ShowToolbar(true);
            //$.mobile.zoom.enable(false);

            MainTouch();
            if (!ISPC)
            {
                AfterLoadPage();
            }
            $("#main").css({ "width": getViewWidth(), "height": getViewHeight() });
            //$(document).bind(EVENTCLICK, Record_click);
            
            //alert(screen.width + "," + window.screen.height);
            //setTimeout(function () {
            //    PlayActionByTxt('{"type":21,"page":1,"CW":706,"CH":3941,"VW":716,"VH":494,"id":"4650f0f4-e71c-ead2-e5b8-b1d20a4aad80","d":"M124,136 L137,136 L150,136 L172,134 L189,134 L208,134 L225,138 L240,144 L256,155 L268,165 L278,176 L288,197 L292,213 L297,232 L305,256 L317,283 L336,317 L355,338 L379,357 L402,370 L426,376 L454,382 L481,382 L518,382 L537,382 L548,380 L551,380","w":"1","color":"#ff0000","save":1,"tar":"","time":61610}');
            //}, 5000);

        }
        function InitPage()
        {
            //whiteboard.SetSizeMode(1);
            whiteboard.SetDeviceType(ISANDROID?2:1);//0:web,1:ios,2:android
            //whiteboard.SetRecord(true);
            whiteboard.SetCanEdit(true);
            whiteboard.OnToolReset(function(res) {
              console.log("OnToolReset:"+res);
              //_activeButton("#liveActionCursor");
                if (res == "") {
                    if (!IsInlineWihteBoardShow) {
                        CanScroll = true;
                    }
                    ResetTools($("#div_btn_pointer"));
                }
            });
            whiteboard.OnReceviceData(function(res) {        
              RecordHandle(res);
              if(res.type!=34 && res.type!=35)
              {
                  //console.log("OnReceviceData:"+ JSON.stringify(res));
                  //whiteboard.Play(res);
              }
            });
            //whiteboard.Init($("#svg1"), $("#main"), $("#pageContainer1"), 1);
    
            whiteboard.OnPageChange(function(pagenumber){
              //console.log("OnPageChange:"+pagenumber);
                PageNumber = pagenumber;
                ToPageNumber = pagenumber;
                ShowPdfInfo();
                CurrentScale = 1;
                AfterChangePage(pagenumber);
                PrestrainPage(pagenumber);
                //updateToolbar();
            });
            whiteboard.OnSelectVideo(function(id, afterSelectVideo) {
                VideoTagSelect(id);
                AfterSelectVideoCall = afterSelectVideo;
              //Context.$refs.syncplayer.selectVideoShow((d)=>{
              //    afterSelectVideo(id,d);
              //});
      
            });
            whiteboard.OnVideoPlay(function(id){
                console.log("OnVideoPlay:" + id);
                VideoTagPlay(id);
              //Context.playVideoTag(id);

            });
            whiteboard.OnBoardDisplayChange(function(isshow){
                console.log("OnBoardDisplayChange:"+isshow);
                IsInlineWihteBoardShow = isshow;
                CanScroll = !isshow;
                //Context.ChangeDrawTool4WhiteBoardDiplayChange(isshow);
            });

            //var bodyScroolTimer = null;
            //var bodyResizeTimer = null;
            //$(window).bind("resize", function() {
            //    //LiveBodyResize();
            //    if (bodyResizeTimer) {
            //        clearTimeout(bodyResizeTimer);
            //    }
            //    bodyResizeTimer = setTimeout(() => {
            //        CheckZoom();
            //    }, 200);
            //});

            // $("#main").bind("scroll", () => {
            //    //loger.log("scrool:" + $(document).scrollTop());
            //    if (bodyScroolTimer) {
            //        clearTimeout(bodyScroolTimer);
            //    }
            //    bodyScroolTimer = setTimeout(() => {
            //        Record_view();
            //    }, 200);
            //});
        }
        function initializeControlWindow() {
            $("#div_btn_pointer").click(function (e) {
                ResetTools($("#div_btn_pointer"));
                whiteboard.SetDrawTool("");
                CanScroll = true;
                return false;
            });
            $("#div_btn_drawline").click(function (e) {
                if ($("#div_btn_drawline").hasClass("selected")) {
                    whiteboard.ShowSetting(true);
                    return;
                }
                whiteboard.SetDrawTool("ToolPen");
                CanScroll = false;
                //docview.ShowDocument("test url");
                ResetTools($("#div_btn_drawline"));
                CloseTools();
                return false;
            });
            $("#div_btn_drawbrush").click(function (e) {
                // whiteboard.Play({"type":35,"poz":[915,228],"bd":0,"page":0,"VW":1574,"ST":0,"SL":0});
                // return;
                if ($("#div_btn_drawbrush").hasClass("selected")) {
                    whiteboard.ShowSetting(true);
                    return;
                }                
                whiteboard.SetDrawTool("ToolBrush");
                CanScroll = false;
                ResetTools($("#div_btn_drawbrush"));
                CloseTools();
                return false;
            });
            $("#div_btn_drawrect").click(function (e) {

                if ($("#div_btn_drawrect").hasClass("selected")) {
                    whiteboard.ShowSetting(true);
                    return;
                }                
                whiteboard.SetDrawTool("ToolLine");
                CanScroll = false;
                ResetTools($("#div_btn_drawrect"));
                CloseTools();
                return false;
            });
            $("#div_btn_text").click(function (e) {                
                whiteboard.SetDrawTool("ToolText");
                CanScroll = false;
                ResetTools($("#div_btn_text"));
                CloseTools();
                return false;
            });
            $("#div_btn_drawrectangle").click(function (e) {                
                whiteboard.SetDrawTool("ToolNote");
                CanScroll = false;
                ResetTools($("#div_btn_drawrectangle"));
                CloseTools();
                return false;
            });
            $("#liveActionDraw").click(function (e) {
                _activeButton("#liveActionDraw");
                //DrawInlineBoard();
                return false;
            });
            $("#div_btn_whiteboard").click(function (e) {
                
                whiteboard.SetDrawTool("ToolBoard");
                CanScroll = false;
                ResetTools($("#div_btn_whiteboard"));
                CloseTools();
                return false;
            });
            $("#div_btn_video").click(function (e) {
                
                whiteboard.SetDrawTool("ToolVideo");
                CanScroll = false;
                ResetTools($("#div_btn_video"));
                CloseTools();
                return false;
            });
            $("#liveActionAddPage").click(function (e) {
                _activeButton("#liveActionAddPage");
                DrawAddPage();
                return false;
            });
            $("#li_btn_clear").click(function (e) {
                //Context.onMasterLessonStart({ lessonId:111});
                //return false;
                //_activeButton("#li_btn_clear");
                //ClearPath();
                whiteboard.SetDrawTool("ToolClear");
                return false;
            });
            $("#li_btn_undo").click(function (e) {
                //alert("todo!");
                whiteboard.Undo();
                return false;
            });
            $("#li_btn_redo").click(function (e) {
                //alert("todo!");
                whiteboard.Redo();
                return false;
            });
            $("#liveActionPlay").click(function (e) {
                //Context.onMasterLessonStart({ lessonId:111});
                //return false;
                _activeButton("#liveActionPlay");
                var span = $("#liveActionPlay").find(">span");
                if (span.hasClass("icon-next")) {
                    span.removeClass("icon-next").addClass("icon-quit");
                    //AutoPlayDocument(true);
                    Context.showAutoPlayDlg = true;
                    //Context.selectAudioName = "";
                } else {
                    span.removeClass("icon-quit").addClass("icon-next");
                    AutoPlayDocument(false);
                    Context.showAutoPlayDlg = false;
                    Context.stopAudio();
                    Context.NoticePlayAudio("", 0);
                }

                return false;
            });
            
            $("#liveActionTools").click(function (e) {
                if ($("#liveActionToolsdiv").is(":visible")) {
                    $("#liveActionToolsdiv").hide();
                    return;
                }
                if (!$("#livePanelMeeting").is(":visible")) {
                    taggleMinControlWindow(true);
                }
                var h = $("#livePanelOperation").height() - 144; //396 280
                $("#liveActionToolsdiv")
                    .css({ top: h })
                    .show();
                $("#liveActionToolscontain")
                    .focus()
                    .bind("blur", function()  {
                        setTimeout(function()  {
                            $("#liveActionToolsdiv").hide();
                        }, 100);
                    });
                return false;
            });
            $("#liveButtonPrevious").click(function (e) {
                LiveDocPreviousPage();

                _cancelDefault(e);
                _cancelBubble(e);
                return false;
            });
            $("#liveButtonNext").click(function (e) {
                LiveDocNextPage();
                _cancelDefault(e);
                _cancelBubble(e);
                return false;
            });
            $("#liveButtonZoomOut").click(function (e) {
                LiveDocZoomOut();

                _cancelDefault(e);
                _cancelBubble(e);
                return false;
            });
            $("#liveButtonZoomIn").click(function (e) {
                LiveDocZoomIn();
                _cancelDefault(e);
                _cancelBubble(e);
                return false;
            });
            $("#liveButtonSizeMode").click(function (e) {
                if ($("#liveButtonSizeMode").hasClass("liveButtonSizeModeWidth")) {
                    $("#liveButtonSizeMode").removeClass("liveButtonSizeModeWidth").addClass("liveButtonSizeModeHeight");
                    whiteboard.SetSizeMode(1);
                }
                else {
                    $("#liveButtonSizeMode").removeClass("liveButtonSizeModeHeight").addClass("liveButtonSizeModeWidth");
                    whiteboard.SetSizeMode(0);
                }
                whiteboard.RefreshDocument(function()  {
                    whiteboard.TriggerViewChange();
                    CurrentScale = 1;
                    //updateToolbar();
                });
            });
        }
        function Record_view() {
            whiteboard.TriggerViewChange();
        }
        function fnErrorTrap(sMsg, sUrl, sLine)
        {
            if (IsShowLog)
            {
                oErrorLog.innerHTML += "Error: " + sMsg + "<br>";
                oErrorLog.innerHTML += "Line: " + sLine + "<br>";
                //oErrorLog.innerHTML += "URL: " + sUrl + "<br>";
            }
            return false;
        }
        window.onerror = fnErrorTrap;
        function MainTouch()
        {
            //return;
            //console.log("MainTouch");
            //$(document.body).find(">div.ui-page").css({ "overflow": "auto" });
            var i = 0;
            //_attachEvent(gid("main"), "touchmove", function (evt)
            //{
            //    ShowMsg("main touchmove" + new Date().getMilliseconds());
            //    //_cancelDefault(evt);
            //    //_cancelBubble(evt);
            //    //return false;
            //});
            //_attachEvent(gid("bodycontainer"), "touchmove", function (evt)
            //{
            //    //ShowMsg("bodycontainer touchmove" + new Date().getMilliseconds());
            //    //ShowMsg(evt.target.tagName + "," + window.innerWidth + "," + document.body.clientWidth);
            //    if (window.innerWidth != document.body.clientWidth)
            //    {
            //        ShowMsg($(document.body).attr("style"));
            //        if (evt['touches'].length == 2)
            //        {
            //            _cancelDefault(evt);
            //            _cancelBubble(evt);
            //            return false;
            //        }
            //    }
            //});
            _attachEvent(gid("moveleft"), "touchmove", function (evt)
            {
                //ShowMsg("touchmove:" + window.innerWidth );
                //window.innerWidth = window.outerWidth;
                _cancelDefault(evt);
                _cancelBubble(evt);
            });
            _attachEvent(gid("moveright"), "touchmove", function (evt)
            {
                //ShowMsg("touchmove:" + window.innerWidth );
                //window.innerWidth = window.outerWidth;
                _cancelDefault(evt);
                _cancelBubble(evt);
            });
            _attachEvent(gid("div_btn_toobar"), "touchmove", function (evt)
            {
                //ShowMsg("touchmove:" + window.innerWidth );
                //window.innerWidth = window.outerWidth;
                _cancelDefault(evt);
                _cancelBubble(evt);
            });

            //var bodyScroolTimer = null;
            //$("#main").unbind("scroll").bind("scroll", function ()
            //{
            //    //console.log("on scroll");
            //    if (bodyScroolTimer)
            //    {
            //        clearTimeout(bodyScroolTimer);
            //    }
            //    bodyScroolTimer = setTimeout(function ()
            //    {
            //        Record_view();
            //    }, 200);

            //});

            var oldw = 0;
            var oldh = 0;
            var oldzoom = 1;
            var oldST = 0;
            var oldSL = 0;
            var oldW = 0;
            var oldH = 0;
            var zoomTimer = null;
            var oldInfo = null;
            //var lastZoomTime = new Date();
            MAINTOUCH = $("#main").touch({
               onEnd: function ()
                {
                    //console.log("on end");
                    Record_view();
                    //$("#main").animate({ left: '0px' }, "fast");
                    //Record_zoom();
                    //Record_scroll();
                },
                beforeZoom: function (midpoint)
                {
                    //alert("beforeZoom");
                    //ShowMsg("beforeZoom:" +midpoint);
                    var container = GetPageContainer(PageNumber);
                    oldw = container.width();
                    oldh = container.height();
                    //oldzoom = parseFloat(container.find(">canvas").css("zoom"));
                    oldST = $("#main").scrollTop() | 0;
                    oldSL = $("#main").scrollLeft() | 0;
                    oldW = getContainerWidth();
                    oldH = getContainerHeight();
                    oldInfo = whiteboard.GetPageInfo();
                    //console.log("before:" + oldInfo.length);
                },
                onZoom: function (zoom, midpoint)
                {
                    if (IsToolBarShow==false)
                    {
                        return;
                    }
                    //ShowMsg("Zoom:" + zoom);
                    var container = GetPageContainer(PageNumber);
                    //var oldw = container.width();
                    //var oldh = container.height();
                    //var oldzoom = container.find(">canvas").css("zoom");
                    var VW = getViewWidth();
                    var VH = getViewHeight();
                    var newW = oldw * zoom;
                    if (newW > VW * 4)
                    {
                        newW = VW * 4;
                        zoom = newW / oldw;
                    }
                    else if (newW < VW * 0.1)
                    {
                        newW = VW * 0.1;
                        zoom = newW / oldw;
                    }
                    var newH = oldh * zoom;

                    if (newW <= VW && newH <= VH)
                    {
                        if (newW / newH < VW / VH)
                        {
                            newH = VH;
                            newW = newH * oldw / oldh;
                            zoom = newH / oldh;
                        }
                        else
                        {
                            newW = VW;
                            newH = newW * oldh / oldw;
                            zoom = newW / oldw;
                        }
                    }
                    //var canvasW = Math.max(VW, newW);
                    //var canvasH = Math.max(VH, newH);
                    //container.find(">svg").width(canvasW).height(canvasH);

                    //var info = GetPageInfo(PageNumber);
                                        
                    
                    container.width(newW).height(newH).attr("CW", newW);
                    $("#svg" + PageNumber).empty();
                    $("#canvas" + PageNumber).width(newW);
                    $("#pageContainer" + PageNumber).height($("#img_" + PageNumber).height());
                    //$("#main").height($("#img_" + PageNumber).height());

                    //container.find(">canvas").css("zoom", parseFloat(oldzoom) * zoom);

                    var newSL = newW * (midpoint[0] + oldSL) / oldW - midpoint[0];
                    var newST = newH * (midpoint[1] + oldST) / oldH - midpoint[1];
                    $("#main").scrollLeft(Math.max(0, newSL));
                    $("#main").scrollTop(Math.max(0, newST));

                    if (zoomTimer)
                    {
                        clearTimeout(zoomTimer);
                    }
                    zoomTimer = setTimeout(function ()
                    {
                        //console.log("draw:"+oldInfo.length);
                        ShowPageInfo(PageNumber, oldInfo);
                        Record_view();
                    }, 300);
                }
            });


        }
        function UnbindMainTouch()
        {
            return;
            if (MAINTOUCH == null) return;
            MAINTOUCH.unbindEvent(document.getElementById("main"), EVENTSTART, MAINTOUCH.ontouchstart);
            MAINTOUCH.unbindEvent(document.getElementById("main"), EVENTEND, MAINTOUCH.ontouchend);
            MAINTOUCH.unbindEvent(document.getElementById("main"), EVENTMOVE, MAINTOUCH.ontouchmove);
            //var div = $(document.body).find(">div.ui-page");
            //div.attr("left", div.scrollLeft()).attr("top", div.scrollTop());
            //$(document.body).find(">div.ui-page").css({ "overflow":"hidden"});
        }
        function BodyChange()
        {
            //ShowMsg("BodyChange");
            //var ow = $('#pageContainer' + PageNumber).width();
            //var cw = $(document.body).width();
            //ZOOM = cw / ow;
            //$("#main").css({ zoom: ZOOM});
            CheckZoom();
        }
        function ShowPdfInfo()
        {
            //console.log("ShowPdfInfo:" + PDFCOUNT);
            if (PDFCOUNT > 0)
            {
                $("#pdfinfo").find(">span").html(GetShowNumber(PageNumber) + "/" + (PDFCOUNT + NewPageList.length));
            }
            else
            {
                $("#pdfinfo").find(">span").html(PageNumber);
            }
        }
        function ShowPdfInfoEx()
        {
            console.log("ShowPdfInfoEx:" + PDFCOUNT);
            if (PDFCOUNT > 0)
            {
                $("#pdfinfo").find(">span").html(GetShowNumber(ToPageNumber) + "/" + (PDFCOUNT + NewPageList.length));
            }
            else
            {
                $("#pdfinfo").find(">span").html(ToPageNumber);
            }
        }
        function GetShowNumber(pageid)
        {
            return pageid;
            var result = 0;
            for (var id of NewPageList)
            {
                if (id <= pageid)
                {
                    result++;
                }
            }
            return Math.floor(pageid) + result;
        }
        function Record()
        {
            CloseTools();
            $("#li_record").hide();
            $("#li_playrecord").hide();
            $("#li_stoprecord").show();
            IsRecord = true;
            RecordTime = new Date();
            RecordAction = new Array();
            whiteboard.SetRecord(true);
            //Record_zoom(true);
            //Record_changepage();
        }
        function RecordHandle(obj)
        {
            if (ISPC)
            {
                //obj.time = new Date() - RecordTime;
                //RecordAction.push(obj);
                //log(JSON.stringify(obj));
                return;
            }
            //console.log("Send:"+JSON.stringify(obj));
            try
            {
                if (ISANDROID)
                {
                    window.AnalyticsWebInterface.reflect(JSON.stringify(obj));
                }
                else
                {
                    window.webkit.messageHandlers.TestFunction.postMessage(JSON.stringify(obj));
                }
            }
            catch (ex) { }
        }
        function VideoTagSelect(id)
        {
            LastVideoTagID = id;
            if (ISPC)
            {
                console.log("VideoTagSelect:" + id);
                return;
            }
            try
            {
                if (ISANDROID)
                {
                    window.AnalyticsWebInterface.videoSelectFunction(null);
                }
                else
                {
                    window.webkit.messageHandlers.VideoSelectFunction.postMessage(null);
                }
            }
            catch (ex) { }
        }
        function VideoTagAfterSelect(info)
        {
            //alert("VideoTagAfterSelect:" + JSON.stringify(info));
            //var id = LastVideoTagID;
            AfterSelectVideoCall(LastVideoTagID,info);
        }
        function VideoTagPlay(id)
        {
            if (ISPC)
            {
                console.log("VideoTagPlay:" + id);
                return;
            }
            try
            {
                if (ISANDROID)
                {
                    window.AnalyticsWebInterface.videoPlayFunction(id);
                }
                else
                {
                    window.webkit.messageHandlers.VideoPlayFunction.postMessage(id);
                }
            }
            catch (ex) { }
        }
        function AfterLoadPage()
        {
            try
            {
                if (ISANDROID)
                {
                    window.AnalyticsWebInterface.afterLoadPageFunction();
                }
                else
                {
                    window.webkit.messageHandlers.AfterLoadPageFunction.postMessage(null);
                }
            }
            catch (ex) { }
        }
        function AfterLoadFile()
        {
            console.log("AfterLoadFile");
            try
            {
                if (ISANDROID)
                {
                    window.AnalyticsWebInterface.afterLoadFileFunction();
                }
                else
                {
                    window.webkit.messageHandlers.AfterLoadFileFunction.postMessage(null);
                }
            }
            catch (ex) { }
        }
        function AfterChangePage(pageid)
        {
            ShowLog("AfterChangePage:" + pageid);
            if (PageNumber != pageid && ToPageNumber != pageid)
            {
                return;
            }           
            try
            {
                if (ISANDROID)
                {
                    window.AnalyticsWebInterface.afterChangePageFunction(pageid);
                }
                else
                {
                    window.webkit.messageHandlers.AfterChangePageFunction.postMessage(pageid);
                }
            }
            catch (ex) { }

        }
        function IsCanvasBlank(canvas)
        {
            return false;
            if (!canvas) return true;
            var blank = document.createElement('canvas');
            blank.width = canvas.width;
            blank.height = canvas.height;
            return canvas.toDataURL() == blank.toDataURL();
        }
        function AutoChangeFile(diff)
        {
            try
            {
                if (ISANDROID)
                {
                    window.AnalyticsWebInterface.autoChangeFileFunction(diff);
                }
                else
                {
                    window.webkit.messageHandlers.AutoChangeFileFunction.postMessage(diff);
                }
            }
            catch (ex) { }
        }
        function addBlankPage(pageid)
        {
            try
            {
                if (ISANDROID)
                {
                    window.AnalyticsWebInterface.addBlankPageFunction(pageid);
                }
                else
                {
                    window.webkit.messageHandlers.AddBlankPageFunction.postMessage(pageid);
                }
            }
            catch (ex) { }
        }
        function GetPageInfo(pageno)
        {
            return whiteboard.GetPageInfo();
        }
        function ShowPageInfo(pageno, oldinfo)
        {
            //console.log("ShowPageInfo");
            for(var info of oldinfo)
            {
                whiteboard.Play(info);
            }
        }
        function getContainerWidth()
        {
            if (GetPageContainer(PageNumber).length == 0)
            {
                return $("#main").width();
            }
            else
            {
                return GetPageContainer(PageNumber).width();
            }
        }
        function getContainerHeight()
        {
            if (GetPageContainer(PageNumber).length == 0)
            {
                return $("#main").height();
            }
            else
            {
                return GetPageContainer(PageNumber).height();
            }
        }
        function getViewWidth()
        {
            return document.body.clientWidth;
        }
        function getViewHeight()
        {
            return document.body.clientHeight;
        }
        function _drawGetSvg(pageno)
        {
            pageno = pageno || PageNumber;           
            if (document.getElementById('svg' + pageno))
            {
                return document.getElementById('svg' + pageno);
            }
            return $('#pageContainer' + pageno).find(">svg")[0];
        }

        function PlayRecordAction(svg, a)
        {
           whiteboard.Play(a);
        }
        function GetPageContainer(pageid)
        {
            var id = '#pageContainer' + pageid;
            id = id.replace(".", "\\.");
            return $(id);
        }
        function GetFixedPageNumber(pageid)
        {
            return (pageid + "").replace(".", "\\.");
        }
        function PrevPage()
        {
            if (IsToolBarShow == false) return;
            if (LastChangeTime && (new Date() - LastChangeTime) < 300)
            {
                return;
            }
            LastChangeTime = new Date();
            var pageno=PageNumber-1;
            if (pageno>0 && GetPageContainer(pageno).length == 0) {
                PreLoadFile(PDFURL, pageno, function ()
                {
                   whiteboard.PreviewPage(function (issuccess, pagenumber) {
                        if (!issuccess && pagenumber == -1) {
                            //change document
                            //console.log("PreviewPage error");
                            AutoChangeFile(-1);
                        }
                        else {

                        }
                    });
                }, false);
            }
            else {
                whiteboard.PreviewPage(function (issuccess, pagenumber) {
                    if (!issuccess && pagenumber == -1) {
                        //change document
                        //console.log("PreviewPage error");
                        AutoChangeFile(-1);
                    }
                    else {

                    }
                });
            }
        }
        function NextPage()
        {
            if (IsToolBarShow == false) return;
            if (LastChangeTime && (new Date() - LastChangeTime) < 300)
            {
                return;
            }
            LastChangeTime = new Date();
            var pageno=PageNumber+1;
            if (pageno <=PDFCOUNT && GetPageContainer(pageno).length == 0) {
                PreLoadFile(PDFURL, pageno, function () {
                   whiteboard.NextPage(function (issuccess, pagenumber) {
                    if (!issuccess && pagenumber == -1) {
                        //change document
                        //console.log("NextPage error");
                        AutoChangeFile(1);
                    }
                    else {

                    }
                });
                }, false);
            }
            else {
                whiteboard.NextPage(function (issuccess, pagenumber) {
                    if (!issuccess && pagenumber == -1) {
                        //change document
                        //console.log("NextPage error");
                        AutoChangeFile(1);
                    }
                    else {

                    }
                });
            }
        }
        function ToHand(evt)
        {
            LastToolFun = null;
            ToPointer();
        }
        function ToPointer(evt)
        {
            //console.log("ToPointer");            
            CloseTools();
            ClearTools();
            ResetTools($("#div_btn_pointer"));
            UnbindMainTouch();
            MainTouch();
        }
        function ChangePageNum(pageno)
        {
            //console.log("ChangePageNum:" + pageno);
            CurrentScale = 1;
            if (pageno <= 0 || pageno > PDFCOUNT)
            {
                if (pageno == 0)
                {
                    ToPageNumber = 1;
                    AutoChangeFile(-1);
                }
                else if (pageno > PDFCOUNT)
                {
                    ToPageNumber = PDFCOUNT;
                    AutoChangeFile(1);
                }
                return;
            }
            if (IsPPT)
            {
                window.Presentation.GotoSlide(pageno);
                AfterChangePage(pageno);
                return;
            }
            //console.log("ChangePageNum ex:" + pageno);
            GetPageContainer(PageNumber).hide();
            $("#editnote,#editnotetext,#editboardmenu,#WBTool_Setting").hide();
            ToPageNumber = pageno;
            if (GetPageContainer(pageno).length == 0)
            {
                ShowPdfInfoEx();
                //console.log("ToPageNumber:"+ToPageNumber);

                IsLoadingPage = true;
                //console.log("CancelLoadPdf ToPageNumber:" + ToPageNumber + ",pageno:" + pageno);
                ShowPDFPage(pageno, function (isscucess)
                {
                    IsLoadingPage = false;
                    if (isscucess == false)
                    {
                        return;
                    }
                    if (pageno != ToPageNumber)
                    {
                        UnbindMainTouch();
                        //ToPointer();
                    }
                    else
                    {
                        //console.log("ShowPDFPage end:" + pageno);
                        PageNumber = pageno;
                        UnbindMainTouch();
                        //ToPointer();
                        Record_changepage();
                        ShowPdfInfo();

                        PrestrainPage(PageNumber);
                        AfterChangePage(PageNumber);
                        $("#main").find(">div.pageContainer[id!='pageContainer" + GetFixedPageNumber(PageNumber) + "']").hide();
                        $('#pageContainer' + PageNumber).show();
                        if (LastToolFun != null)
                        {
                            LastToolFun();
                        }
                        else
                        {
                            ToPointer();
                        }
                    }

                });
                return;
            }
            else
            {
                if (pageno != ToPageNumber)
                {
                    return;
                }
                PageNumber = pageno;
                Record_changepage();
                ShowPdfInfo();                
                $("#main").find(">div.pageContainer[id!='pageContainer" + GetFixedPageNumber(pageno) + "']").hide();
                GetPageContainer(pageno).find(">div.boardcontainer").hide();
                GetPageContainer(pageno).show();
                CheckZoom();
                UnbindMainTouch();
                //ToPointer();
                AfterChangePage(PageNumber);
                PrestrainPage(PageNumber);
                if (LastToolFun != null)
                {
                    LastToolFun();
                }
                else
                {
                    ToPointer();
                }
            }
        }
        function PrestrainPage(pageno)
        {
            pageno = Math.floor(pageno);
            ShowLog("PrestrainPage:" + pageno);
            if (PDFCOUNT <= 1)
            {
                return;
            }
            var ToLoadList = new Array();
            for (var i = pageno - 1; i <= pageno + 1; i++)
            {
                if (i > 0 && i <= PDFCOUNT)
                {
                    if (!IsExistInArr(ToLoadList, i))
                    {
                        ToLoadList.push(i);
                    }
                }
            }
            for (var j = 0; j < ToLoadList.length; j++)
            {
                if (!ToLoadList[j] || ToLoadList[j] > PDFCOUNT || ToLoadList[j] < 1)
                {
                    continue;
                }
                if (GetPageContainer(ToLoadList[j]).length == 0)
                {
                    //console.log("Pre load:" + ToLoadList[j]);
                    ShowPDFPage(ToLoadList[j], function () { }, true, false);
                }

            }

        }
        function ShowPDFPage(pageNum, callback, ishide, needScale)
        {
            PreLoadFile(PDFURL, pageNum, function ()
            {
                whiteboard.PreLoadPage(pageNum, function () {
                    ShowLog("PreLoadPage end");
                });
            }, ishide);
        }
        function PreLoadFile(Url, pageNum, callback, ishide)
        {
            //console.log("PreLoadFile:" + pageNum);
            var ispc = location.href.toLowerCase().indexOf("http") == 0;
            if (ispc || Url.toLowerCase().indexOf("http") == 0)
            {
                if (callback) callback();
                return;
            }
            SetLoadFileCallBack(Url, pageNum, callback);
            var showLoading = true;
            if (typeof (ishide) != "undefined" && ishide == true)
            {
                showLoading = false;
            }
            try
            {
                if (ISANDROID)
                {
                    window.AnalyticsWebInterface.preLoadFileFunction(Url, pageNum, showLoading);
                }
                else
                {
                    window.webkit.messageHandlers.PreLoadFileFunction.postMessage({ "Url": Url, "pageNum": pageNum, "showLoading": showLoading });
                }
            }
            catch (ex) { }
        }
        function AfterDownloadFile(Url, pageNum)
        {
            ShowLog("AfterDownloadFile:" + pageNum);
            var callback = GetLoadFileCallBack(Url, pageNum);
            if (callback) callback();
        }
        function SetLoadFileCallBack(Url, pageNum, callback)
        {
            PDFMAP.set(pageNum + "<>" + Url, callback);
        }
        function GetLoadFileCallBack(Url, pageNum)
        {
            var callback = PDFMAP.get(pageNum + "<>" + Url);
            PDFMAP.remove(pageNum + "<>" + Url);
            return callback;
        }
        function ClearPath()
        {
            whiteboard.Clear();
            
            CloseTools();
        }
        function ClearTools()
        {
            //$("#main").unbind();
            //if (DrawTarget != null)
            //{
            //    DrawTarget.unbind();
            //}
        }
        function ClearPageAndAction() {
            $("#main").find(">div.pageContainer[id!='pageContainer" +GetFixedPageNumber(PageNumber) + "']").remove();
            ClearPath();
        }
        function ResetTools(cur)
        {
            $("#div_btn_drawline").removeClass("selected");
            $("#div_btn_drawbrush").removeClass("selected");
            $("#div_btn_drawrect").removeClass("selected");
            $("#div_btn_pointer").removeClass("selected");
            $("#div_btn_drawrectangle").removeClass("selected");
            $("#div_btn_whiteboard").removeClass("selected");
            $("#div_btn_text").removeClass("selected");
            $("#div_btn_video").removeClass("selected");
            //console.log("ResetTools");

            if (cur)
            {
                setTimeout(function () { cur.addClass("selected"); }, 50);
            }
        }
        function ShowMsg(msg)
        {
            console.log(msg);
            //var span = $("#msg").find("span");
            //$("#msg").show();
            //var arrtime = span.html().split("<br>");
            //if (arrtime.length >= 10)
            //{
            //    arrtime = arrtime.slice(arrtime.length - 10);
            //    span.html(arrtime.join("<br>") + "<br>" + msg);
            //}
            //else
            //{
            //    arrtime.push(msg);
            //    span.html(span.html() + "<br>" + msg);
            //}
            //return;
            //setTimeout(function ()
            //{
            //    //console.log(span.html());
            //    var arr = span.html().split("<br>");
            //    if (arr.length == 1)
            //    {
            //        span.html("");
            //        //span.hide();
            //    }
            //    else
            //    {
            //        arr = arr.slice(1);
            //        span.html(arr.join("<br>"));
            //    }
            //}, 2000 + arrtime.length*100);
            //if (IsShowLog == true)
            //{
            //    $('#msg').stop();
            //    $("#msg").css({ left: "-500px" }).show();
            //    $("#msg").find("span").html(msg);
            //    $('#msg').stop().animate({ left: '15px', opacity: 1 }, 100).delay(1500).animate({ left: '-500px', opacity: 1 }, 10);
            //}
        }
        function ShowLog(log)
        {
            //console.log("ShowLog");
            if (IsShowLog == true)
            {
                ShowMsg(log);
            }
        }
        function CloseToolSetting()
        {
            $("#main").css({ "margin-bottom": "0px" });
            $("#toolssetting").css({ "visibility": "hidden" });
        }
        function CloseToolsEx()
        {
            //console.log("CloseToolsEx");
            //$('#maintools').panel('close');
            $("#maintools").stop().animate({ right: '-36px', opacity: 0 }, 100, 'swing', function ()
            {
                $("#maintools").hide();
                //$("#div_btn_toobar").css("opacity", '0').show().animate({ opacity: 1 }, 500);
                $("#div_btn_toobar").show();
            });

        }
        function CloseTools()
        {
            //console.log("CloseTools");
            $("#maintools").hide();
            if (IsToolBarShow)
            {
                $("#div_btn_toobar").show();
            }
            else
            {
                $("#div_btn_toobar").hide();
                //ToPointer();
            }
        }
        function AfterLoadPDF(pageNum)
        {
            ShowLog("AfterLoadPDF:" + pageNum);
            IsLoadingPage = false;
            PageNumber = pageNum;
            ShowPdfInfo();
            Record_view();
            PrestrainPage(PageNumber);
            AfterLoadFile();
            AfterChangePage(PageNumber);
            //alert("pdf loaded");
            //CheckZoom();
            //setTimeout(CheckZoom, 1000);
            //setTimeout(CheckZoom, 3000);
            //setTimeout(CheckZoom, 6000);
            //setTimeout(CheckZoom, 12000);
        }
        function SetShowLog()
        {
            IsShowLog = !IsShowLog;
            if (IsShowLog == true)
            {
                setTimeout(function () { $("#div_btn_log").addClass("selected"); }, 500);
            }
            else
            {
                setTimeout(function () { $("#div_btn_log").removeClass("selected"); }, 500);
            }
            //CloseTools();
        }
        function CheckZoom()
        {
            return;
            var container = GetPageContainer(PageNumber);
            var ow = parseInt(container.attr("CW"));
            var cw = getViewWidth() * CurrentScale;
            var diff = Math.abs(ow - cw);
            if (diff < 50)
            {
                return;
            }
            ShowLog("CheckZoom");
            $("#main").css({ "width": getViewWidth(), "height": getViewHeight() });

            if (IsPPT)
            {
                ZOOM = document.body.clientWidth / (presSettings.Width + 2);
                //$("#main").css({ "zoom": ZOOM });
                $("#main").css({ "transform": "scale(" + ZOOM + ", " + ZOOM + ")" });

            }
            else
            {
                //IsLoadingPage = true;
                var info = GetPageInfo(PageNumber);
                $("#svg" + PageNumber).empty();
                var newW = getViewWidth() * CurrentScale;
                $("#pageContainer" + PageNumber).css({ "width": newW }).attr("CW", newW);
                $("#canvas" + PageNumber).width(newW);
                $("#pageContainer" + PageNumber).height($("#img_" + PageNumber).height());
                //$("#main").height($("#img_" + PageNumber).height());
                setTimeout(function ()
                {
                    ShowPageInfo(PageNumber, info);
                }, 300);
                
                DrawTarget = null;
                ToPointer();
            }
        }

        function PlayActionByTxt(txt, AttachmentID)
        {
            //var actions = ParseAction(txt);
            ShowLog(AttachmentID + "#" + txt);
            if (CurrentAttachmentID != "" && AttachmentID && AttachmentID != "" && AttachmentID + "" != CurrentAttachmentID)
            {
                return;
            }
            AttachmentID = AttachmentID || "";
            
            var a = JSON.parse(txt);
            if (a.type && a.type == 2)
            {
                PlayRecordAction(null, a);
                return;
            }
            var pageid = PageNumber;
            if (a.page && a.page != 0)
            {
                pageid = a.page;
            }

            var svg = _drawGetSvg(pageid);//$('#pageContainer' + PageNumber).find(">svg");
            if (!svg)
            {
                window.setTimeoutEx(RePlayAction, 1500, a, 1, AttachmentID);//teacher change page too faster, student no svg to draw line. so delay draw
                return;
            }
            
            PlayRecordAction(svg, a);
        }
        function PlayActionByArray(arr, AttachmentID)
        {
            //ShowLog("beofre PlayActionByArray:" + new Date().toLocaleTimeString());
            if (CurrentAttachmentID != "" && AttachmentID && AttachmentID != "" && AttachmentID + "" != CurrentAttachmentID)
            {
                return;
            }
            for (var i = 0, j = arr.length; i < j; i++)
            {
                var a = JSON.parse(arr[i]);
                if (a.type && (a.type == 2 || a.type == 32))
                {
                    continue;
                }
                var pageid = PageNumber;
                if (a.page && a.page != 0)
                {
                    pageid = a.page;
                }
                var svg = _drawGetSvg(pageid);
                if (svg)
                {
                    window.setTimeoutEx(PlayRecordAction, (i + 1) * 50, svg, a);
                }

            }
            //ShowLog("after PlayActionByArray:" + new Date().toLocaleTimeString());
        }
        function RePlayAction(a, count,atmid)
        {
            if (CurrentAttachmentID != "" && atmid != "" && atmid + "" != CurrentAttachmentID)
            {
                return;
            }
            var pageid = PageNumber;
            if (a.page && a.page != 0)
            {
                pageid = a.page;
            }

            var svg = _drawGetSvg(pageid);
            if (!svg)
            {
                if (count > 3)
                {
                    return;
                }
                window.setTimeoutEx(RePlayAction, 2000, a, count + 1, atmid);
                return;
            }
            else
            {
                PlayRecordAction(svg, a);
            }
        }
        function ShowToolbar(isshow)
        {
            if (isshow)
            {
                $("#div_btn_toobar").show();
                
            }
            else
            {
                $("#div_btn_toobar").hide();
                ToPointer();
            }
            $("#liveMouse").hide();
            IsToolBarShow = isshow;
            whiteboard.SetCanEdit(isshow);
        }
        function ShowToolbarEx(isshow)
        {
            if (isshow)
            {
                $("#div_btn_toobar").show();
                
            }
            else
            {
                $("#div_btn_toobar").hide();
                //ToPointer();
                setTimeout(function () {$("#div_btn_toobar").hide(); },500);
            }
        }
        function GetCurrentPageNumber() {
            return PageNumber;
        }
        function ShowPDF(Url, pageNum, BlankPageNumber,AttachmentID)
        {
            if (AttachmentID)
            {
                CurrentAttachmentID = AttachmentID+"";
            }
            else
            {
                CurrentAttachmentID = "";
            }
            ShowLog("ShowPDF:" + Url + "," + pageNum + "," + AttachmentID);
            PDFURL = Url;
            PageNumber = pageNum;
            ToPageNumber = pageNum;
            whiteboard.ShowDocument($("#main"), Url, pageNum, function(issuccess, pdfcount)  {
                if (AfterLoadPDF) AfterLoadPDF(pageNum);
                PDFCOUNT=pdfcount;
                ShowPdfInfo();
            });
            return;
            PDFCOUNT = GetImageCount(Url);
            PDFURL = Url;
            PageNumber = pageNum;
            ToPageNumber = pageNum;
            IsPPT = false;
            ShowPDFFile(Url, pageNum, function ()
            {
                ShowPdfInfo();
            });
        }
        function SetSizeMode(mode) {
            whiteboard.SetSizeMode(mode);
            whiteboard.RefreshDocument(function()  {
                //whiteboard.TriggerViewChange();
                CurrentScale = 1;
            });
        }
        function ShowDebugInfo(isshow)
        {
            if (isshow)
            {
                vConsole.show();
            }
            else
            {
                vConsole.hide();
            }
        }
        function log(log)
        {
            console.log(log);
        }       
        function ShowToolBarItem(evt)
        {
            //var txt ='{"type":34,"delay":1,"poz":[[255,462],[235,493],[235,506],[60,15],[72,0],[67,57]],"page":0,"VW":1574,"ST":0,"SL":0}'
            //var txt = '{"type":32,"page":0,"CW":2676,"CH":1505,"VW":1574,"VH":941,"ST":1338,"SL":0}';
            //PlayActionByTxt(txt);
            //return;
            //debugger;
            //CurrentScale = 1.5;
            //CheckZoom();
            //return;
            //console.log("ShowToolBarItem");
            //ShowMsg($('#pageContainer' + PageNumber).attr("CW") + "," + $(document.body).width());
            //$("#maintools").panel("open");

            //PlayActionByTxt('{"type":32,"page":1,"CW":553,"CH":715,"VW":1393,"VH":503,"ST":0,"SL":0}');
            //setTimeout(function ()
            //{
            //    //{"type":32,"page":1,"CW":308,"CH":398,"VW":1393,"VH":503,"ST":0,"SL":0}
            //    PlayActionByTxt('{"type":32,"page":1,"CW":308,"CH":398,"VW":1393,"VH":503,"ST":0,"SL":0}');
            //}, 5000);
            //return
            _cancelBubble(evt);
            $("#div_btn_toobar").hide();
            $("#maintools").stop().show().animate({ right: '0px', opacity: 1 }, 100);
        }
        function FullScreen()
        {
            //debugger;
            //PlayActionByTxt('{"type":2,"page":' + (PageNumber+1)+'}')
            //return;
            CloseTools();
            try
            {
                if (ISANDROID)
                {
                    window.AnalyticsWebInterface.screenFunction();
                }
                else
                {
                    window.webkit.messageHandlers.ScreenFunction.postMessage(null);
                }

            }
            catch (ex) { }

            setTimeout(function () { CheckZoom() }, 500);
        }
        function RotateScreen()
        {
            CloseTools();
            try
            {
                window.webkit.messageHandlers.RotationFunction.postMessage(null);
            }
            catch (ex) { }
        }
        function StopRecord()
        {
            whiteboard.SetRecord(false);
            if (IsRecord)
            {
                CloseTools();
                IsRecord = false;
                $("#li_record").show();
                $("#li_playrecord").show();
                if (RecordAction != null)
                {
                    $("#recordactions").val(JSON.stringify(RecordAction));
                }
                ShowMsg("Stop Record!");
                //recorder.stop();
                //alert($("#recordactions").val());
            }
            else if (IsPlay)
            {
                IsPlay = false;
                clearTimeout(PalyTimer);
                ShowMsg("Play End!");
                $("#li_record").show();
                $("#li_playrecord").show();
                $("#li_pointer,#li_btn_drawline,#li_btn_drawrect,#li_btn_drawbrush").show();

            }
        }

        function Zoom(zoom)
        {
            ZOOM = zoom;
            //$('#pageContainer' + PageNumber).remove();
            //ShowPDFPage(PDFDOC, PDFSVG, PageNumber);
            $("#main").css({ zoom: zoom });
        }
        function ShowZoom()
        {
            var zoom = 1;
            if (typeof top.DetectZoom == 'object' && typeof top.DetectZoom.zoom == 'function')
            {
                zoom = top.DetectZoom.zoom();
            }
            alert(zoom);
        }
    </script>
    <style>
        body {
            width: 100%;
            height: 100%;
            text-align: left;
            padding: 0px;
            margin: 0px;
            border: 0px;
            background-color: white;
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
        }

        .bodycontainer {
            width: 100%;
            height: 100%;
            padding: 0px;
            margin: 0px;
            border: 0px;
            background-color: white;
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
        }

            .bodycontainer:focus {
                background-color: white;
            }

        svg {
            touch-action: none;
        }

        html, form {
            width: 100%;
            height: 100%;
        }

        *:focus {
            outline: none;
        }

        .btn {
            padding: 6px 10px;
            border: 1px solid #d3d3d3;
            border-radius: 5px;
            display: inline-block;
        }

        .pageContainer {
            border: 0px solid #000;
            margin: 0px auto;
            background-color: #FFF;
            display: inline-block;
            position:relative;
        }

        .toolspanel > div:first-child {
            padding: 0px;
            height: 100%;
        }

        .toolspanel h4 {
            padding: 0px;
        }

        .toolssetting {
        }

            .toolssetting li {
                float: left;
                width: 20%;
            }

        .navigatelist {
        }

            .navigatelist li {
                padding: 0px 8px 0px 0px;
            }

                .navigatelist li div {
                    margin: 0.1em 0;
                }

        .editnotemenu {
        }

            .editnotemenu ul {
                list-style: none;
                padding: 0px;
                margin: 0px;
                display: inline;
            }

            .editnotemenu li {
                float: left;
                padding: 2px 5px;
                border-right: 1px solid white;
            }

                .editnotemenu li:last-child {
                    border-right: 0px;
                }

        .resizebg_nw {
            background: url("img/resizebg.png") bottom right no-repeat;
        }

        .resizebg_ne {
            background: url("img/resizebg.png") bottom left no-repeat;
        }

        .resizebg_sw {
            background: url("img/resizebg.png") top right no-repeat;
        }

        .resizebg_se {
            background: url("img/resizebg.png") top left no-repeat;
        }

        .ui-icon-pen:after {
            background-image: url("img/pen_white.svg");
        }

        .ui-icon-line:after {
            background-image: url("img/line_white.svg");
        }

        .ui-icon-next:after {
            background-image: url("img/next_orange.svg");
        }

        .ui-icon-paly:after {
            background-image: url("img/Play_white.svg");
        }

        .ui-icon-stoprecord:after {
            background-image: url("img/StopRecord_white.svg");
        }

        .ui-icon-text:after {
            background-image: url("img/text_white.svg");
        }

        .ui-icon-pointer:after {
            background-image: url("img/pointer_red.svg");
        }

        .ui-icon-rectangle:after {
            background-image: url("img/Rectangle_white.svg");
        }

        .ui-icon-highlighter:after {
            background-image: url("img/highlighter_white.svg");
        }

        .ui-icon-done:after {
            background-image: url("img/done_orange.svg");
        }

        .ui-icon-clearall:after {
            background-image: url("img/ClearAllAnnotation_white.svg");
        }

        .ui-icon-addpage:after {
            background-image: url("img/action-addpage.svg");
        }

        .ui-icon-image:after {
            background-image: url("img/Image_white.svg");
        }

        .ui-icon-panandzoom:after {
            background-image: url("img/PanAndZoom_orange.svg");
        }

        .ui-icon-pause:after {
            background-image: url("img/pause_white.svg");
        }

        .ui-icon-return:after {
            background-image: url("img/return_orange.svg");
        }

        .ui-icon-moveleft:after {
            background-image: url("img/left_blue.svg");
        }

        .ui-icon-moveright:after {
            background-image: url("img/right_blue.svg");
        }

        .ui-icon-whiteboard:after {
            background-image: url("img/Brushmarks_white.svg");
        }

        .ui-icon-fullscreen:after {
            background-image: url("img/fullscreen_white.svg");
        }

        .ui-icon-rotateright:after {
            background-image: url("img/rotateright_white.svg");
        }

        .ui-icon-note:after {
            background-image: url("img/Textmarks_white.svg");
        }

        .btn-icon-container {
            height: 29px;
            width: 36px;
            padding: 0px;
            border: 0px;
        }

        .btn-icon-container.selected {
            color: #4A90E2;
            background-color: #c5c5c5;
        }
        .WBTool_btn {
            cursor: pointer;
            margin-left: 15px;
            width: 40px;
            height: 40px;
            padding: 8px 4px 0px 4px;
            border: 1px solid #fff;
        }
        .boardhead
        {
            padding-left:80px;
        }
        .live-video-tool-container {
            position: absolute;
            border: 1px solid rgba(0,0,0,0);
            border-radius: 50%;
            width: 100px;
            height: 100px;
        }

        .live-video-tool-icon {
            border: 1px solid #e2e2e2;
            margin-left: 34px;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            background-color: #f6a925;
            text-align: center;
            margin-top: 35px;
            padding-top: 6px;
            display: inline-block;
            cursor: pointer;
            box-sizing: border-box;
        }

        .live-video-tool-edit {
            position: relative;
            top: -35px;
            right: 0px;
            border: 1px solid #e2e2e2;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            background-color: #4592e0;
            text-align: center;
            margin-top: 35px;
            padding-top: 4px;
            display: inline-block;
            visibility: hidden;
            cursor: pointer;
            box-sizing: border-box;
        }

        .live-video-tool-play {
            position: relative;
            bottom: 30px;
            border: 1px solid #e2e2e2;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            background-color: #f6a925;
            text-align: center;
            margin-top: 35px;
            padding-top: 3px;
            display: inline-block;
            visibility: hidden;
            cursor: pointer;
            box-sizing: border-box;
        }

        .live-video-tool-container.selected {
            border: 1px solid #e2e2e2;
        }

            .live-video-tool-container.selected .live-video-tool-play {
                visibility: visible;
            }

            .live-video-tool-container.selected .live-video-tool-edit {
                visibility: visible;
            }

        .live-video-tool-editvideo {
            position: absolute;
            border: solid 1px #d3d3d3;
            width: 300px;
            height: 202px;
            padding: 8px;
            background-color: white;
            box-sizing: border-box;
        }

        .live-video-tool-edit-top {
            height: 30px;
            text-align: left;
            border-bottom: solid 1px #d3d3d3;
        }

        .live-video-tool-edit-bottom {
            height: 30px;
            border-top: solid 1px #d3d3d3;
            text-align: center;
            line-height: 30px;
            vertical-align: middle;
        }

        .live-video-tool-edit-selectvideo {
            display: inline-block;
            background-color: #007eae;
            color: white;
            border-radius: 5px;
            padding: 5px 20px;
            cursor: pointer;
        }

        .live-video-tool-edit-cancel {
            padding: 2px;
            display: inline-block;
            width: 130px;
            cursor: pointer;
        }

        .live-video-tool-edit-save {
            border-left: solid 1px #d3d3d3;
            padding: 2px;
            display: inline-block;
            margin-top: 2px;
            width: 130px;
            cursor: pointer;
        }
        .live-video-tool-edit-sync {
            background-color: #007eae;
            color: white;
            border-radius: 5px;
            padding: 5px 20px;
            cursor: pointer;
        }

        .live-video-tool-edit-del {
            float: right;
            cursor: pointer;
        }

        .live-video-tool-edit-listcontainer {
            height: 65px;
            overflow: auto;
        }

            .live-video-tool-edit-listcontainer ul {
                list-style: none;
                padding: 0px;
                margin: 0px;
            }

            .live-video-tool-edit-listcontainer li {
                float: left;
            }

        .live-video-tool-edit-selectcontainer {
            clear: both;
            text-align: center;
        }

        .live-video-tool-edit-changecontainer {
            clear: both;
            bottom: 0px;
        }
    </style>
</head>
<body onload="BodyOnload();" onresize="BodyChange();">
    <div id="bodycontainer" class="bodycontainer" tabindex="1">
        <div id="main" style="text-align:center; position: relative;height:100%;width:100%; margin-bottom:0px;transform-origin: top left;  overflow:auto;"></div>
        <!--div id="maincontainer" style="text-align:center; position:relative; display:inline-block; top:-15px; height:100%;">
    </!--div-->
        <div style="z-index:102; position:fixed; top:40px; left:15px; display:none; color:red; font-size:20px;" id="msg">
            <span></span><audio id="adRecord" autoplay></audio>
        </div>
        <div style="z-index:2; position:fixed; top:5px; left:5px; color:black; font-size:12px;" id="pdfinfo">
            <span></span>
        </div>
        <div style="z-index:2; position:fixed; bottom:40%; left:5px; color:black; font-size:12px;" id="moveleft" onclick="PrevPage(); _cancelBubble(event); return false;" ontouchstart="PrevPage(); _cancelBubble(event); return false;">
            <div>
                <img src="img/left_blue.svg" style="width:50px;height:50px;" />
            </div>
        </div>
        <div style="z-index:2; position:fixed; bottom:40%; right:5px; color:black; font-size:12px;" id="moveright" onclick="NextPage();_cancelBubble(event); return false;" ontouchstart="NextPage();_cancelBubble(event); return false;">
            <div>
                <img src="img/right_blue.svg" style="width:50px;height:50px;" />
            </div>
        </div>
        <div style="z-index:2; position:fixed; top:3px; right:3px; " id="div_btn_toobar">
            <div style="border:1px solid #b2b2b2; border-radius:50%; cursor:pointer;padding:2px 3px 2px; margin:0px; background-color:#efefef;">
                <span class="icon icon-leftarrow" onclick="ShowToolBarItem(event);return false;" ontouchstart="ShowToolBarItem(event);return false;"></span>
            </div>
        </div>
        <div style="z-index:2; position:fixed; top:0px; right:70px;display:none;">
            <div class="ui-input-btn ui-btn ui-icon-fullscreen ui-btn-icon-notext ui-corner-all">
                <input type="button" data-enhanced="true" value="Enhanced - Icon only" onclick="FullScreen();">
            </div>
        </div>
        <div id="maintools" data-role="panel" data-position="right" data-position-fixed="true" data-display="overlay" data-theme="a" class="toolspanel" style="z-index:3; width:36px; right:-36px; padding:0px; position:fixed;display:none;box-shadow: -3px 0px 3px rgb(218, 216, 216); border-left:#ccc solid 1px; top:0px; height:100%; background-color:white;" onclick="">
            <ul class="navigatelist" style="list-style: none; padding: 0px 0px; margin: 0px; float:left; margin:0px; text-align:center; width:100%;">
                <li id="li_btn_closetools" style="">
                    <div id="div_btn_closetools" class="btn-icon-container" isdraw="0" style="text-align:center;">
                        <!--<input type="button" data-enhanced="true" value="Enhanced - Icon only" onclick="CloseTools();">-->
                        <span class="icon icon-rightarrow" onclick="CloseToolsEx();return false;"></span>
                    </div>
                </li>
              
                <li id="li_pointer">
                    <div id="div_btn_pointer" class="btn-icon-container selected" style="text-align:center;">
                        <!--<input type="button" data-enhanced="true" value="Enhanced - Icon only" onclick="ToPointer();">-->
                        <span class="icon icon-hand" onclick="ToHand(event);"></span>
                    </div>
                </li>
                <li id="li_rotatescreen" style="display:none;">
                    <div id="div_btn_rotatescreen" class="ui-input-btn ui-btn ui-btn-inline ui-icon-rotateright ui-btn-icon-notext ui-corner-all" style="text-align:center;">
                        <input type="button" data-enhanced="true" value="Enhanced - Icon only" onclick="RotateScreen();">
                    </div>
                </li>
                <li id="li_btn_drawline">
                    <div id="div_btn_drawline" class="btn-icon-container" isdraw="0" style="text-align:center;">
                        <!--<input type="button" data-enhanced="true" value="Enhanced - Icon only" onclick="DrawLine();">-->
                        <span class="icon icon-pencil"></span>
                    </div>
                </li>
                <li id="li_btn_drawrect">
                    <div id="div_btn_drawrect" class="btn-icon-container" isdraw="0" style="text-align:center;">
                        <!--<input type="button" data-enhanced="true" value="Enhanced - Icon only" onclick="DrawRect();">-->
                        <span class="icon icon-Line"></span>
                    </div>
                </li>
                <li id="li_btn_drawbrush">
                    <div id="div_btn_drawbrush" class="btn-icon-container" isdraw="0" style="text-align:center;">
                        <!--<input type="button" data-enhanced="true" value="Enhanced - Icon only" onclick="DrawBrush();">-->
                        <span class="icon icon-mark" ></span>
                    </div>
                </li>
                <li id="li_btn_text">
                    <div id="div_btn_text" class="btn-icon-container" isdraw="0" style="text-align:center;">
                        <!--<input type="button" data-enhanced="true" value="Enhanced - Icon only" onclick="DrawText();">-->
                        <span class="icon icon-text"></span>
                    </div>
                </li>
                <li id="li_btn_drawrectangle">
                    <div id="div_btn_drawrectangle" class="btn-icon-container" isdraw="0" style="text-align:center;">
                        <!--<input type="button" data-enhanced="true" value="Enhanced - Icon only" onclick="DrawRectangle();">-->
                        <span class="icon icon-tips" ></span>
                    </div>
                </li>
                <li id="li_btn_whiteboard">
                    <div id="div_btn_whiteboard" class="btn-icon-container" isdraw="0" style="text-align:center;">
                        <!--<input type="button" data-enhanced="true" value="Enhanced - Icon only" onclick="DrawWhiteBoard();">-->
                        <span class="icon icon-board" ></span>
                    </div>
                </li>
                <li id="li_btn_video">
                    <div id="div_btn_video" class="btn-icon-container" isdraw="0" style="text-align:center;">
                        <span class="icon icon-insertVideo"></span>
                    </div>
                </li>
                <!--<li id="li_btn_addpage">
                <div id="div_btn_addpage" class="ui-input-btn ui-btn ui-btn-inline ui-icon-addpage ui-btn-icon-notext ui-corner-all" isdraw="0" style="text-align:center;">
                    <input type="button" data-enhanced="true" value="Enhanced - Icon only" onclick="DrawAddPage();">
                </div>
            </li>-->
                <li id="li_btn_clear">
                    <div id="div_btn_clear" class="btn-icon-container" isdraw="0" style="text-align:center;">
                        <!--<input type="button" data-enhanced="true" value="Enhanced - Icon only" onclick="ClearPath();">-->
                        <span class="icon icon-clearall" ></span>
                    </div>
                </li>
                <li id="li_btn_undo">
                    <div id="div_btn_undo" class="btn-icon-container" isdraw="0" style="text-align:center;">
                        <!--<input type="button" data-enhanced="true" value="Enhanced - Icon only" onclick="ClearPath();">-->
                        <span class="icon icon-undo" ></span>
                    </div>
                </li>
                <li id="li_btn_redo">
                    <div id="div_btn_redo" class="btn-icon-container" isdraw="0" style="text-align:center;">
                        <!--<input type="button" data-enhanced="true" value="Enhanced - Icon only" onclick="ClearPath();">-->
                        <span class="icon icon-redo" ></span>
                    </div>
                </li>
                <li id="li_btn_log" style="display:none;">
                    <div id="div_btn_log" class="ui-input-btn ui-btn ui-btn-inline ui-icon-info ui-btn-icon-notext ui-corner-all" isdraw="0" style="text-align:center;">
                        <input type="button" data-enhanced="true" value="Enhanced - Icon only" onclick="SetShowLog();">
                    </div>
                </li>

            </ul>
        </div>
        <DIV ID="oErrorLog" style="z-index:1000; position:absolute;  top:0px;left:0px; color:red;">
        </DIV>
        <textarea id="action" style="display:none;"></textarea>
        <textarea id="recordactions" style="display:none;"></textarea>
    </div>
    <script src="js/vconsole.min.js"></script>
    <script type="text/javascript">
        var vConsole = new VConsole();
        vConsole.setOption('onReady', function ()
        {
            vConsole.hideSwitch();
            //vConsole.show();
        });
        
    </script>
</body>
</html>
